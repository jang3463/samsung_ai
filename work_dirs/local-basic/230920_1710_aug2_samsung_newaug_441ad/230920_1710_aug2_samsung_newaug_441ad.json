{"log_config": {"interval": 50, "hooks": [{"type": "TextLoggerHook", "by_epoch": false}]}, "dist_params": {"backend": "nccl"}, "log_level": "INFO", "load_from": null, "resume_from": null, "workflow": [["train", 1]], "cudnn_benchmark": true, "norm_cfg": {"type": "BN", "requires_grad": true}, "find_unused_parameters": true, "model": {"type": "HRDAEncoderDecoder", "pretrained": "pretrained/mit_b5.pth", "backbone": {"type": "mit_b5", "style": "pytorch"}, "decode_head": {"type": "HRDAHead", "in_channels": [64, 128, 320, 512], "in_index": [0, 1, 2, 3], "channels": 256, "dropout_ratio": 0.1, "num_classes": 12, "norm_cfg": {"type": "BN", "requires_grad": true}, "align_corners": false, "decoder_params": {"embed_dims": 256, "embed_cfg": {"type": "mlp", "act_cfg": null, "norm_cfg": null}, "embed_neck_cfg": {"type": "mlp", "act_cfg": null, "norm_cfg": null}, "fusion_cfg": {"type": "aspp", "sep": true, "dilations": [1, 6, 12, 18], "pool": false, "act_cfg": {"type": "ReLU"}, "norm_cfg": {"type": "BN", "requires_grad": true}}}, "loss_decode": {"type": "CrossEntropyLoss", "use_sigmoid": false, "loss_weight": 1.0, "loss_name": "loss_ce"}, "single_scale_head": "DAFormerHead", "attention_classwise": true, "hr_loss_weight": 0.1}, "train_cfg": {"work_dir": "work_dirs/local-basic/230920_1710_aug2_samsung_newaug_441ad"}, "test_cfg": {"mode": "slide", "batched_slide": true, "stride": [512, 512], "crop_size": [1024, 1024]}, "scales": [1, 0.5], "hr_crop_size": [512, 512], "feature_scale": 0.5, "crop_coord_divisible": 8, "hr_slide_inference": true}, "dataset_type": "samsung", "data_root": "data/samsung_source/", "img_norm_cfg": {"mean": [123.675, 116.28, 103.53], "std": [58.395, 57.12, 57.375], "to_rgb": true}, "crop_size": [1024, 1024], "gta_train_pipeline": [{"type": "LoadImageFromFile"}, {"type": "LoadAnnotations"}, {"type": "Resize", "img_scale": [2048, 1024]}, {"type": "RandomCrop", "crop_size": [1024, 1024], "cat_max_ratio": 0.75}, {"type": "RandomFlip", "prob": 0.5}, {"type": "PhotoMetricDistortion"}, {"type": "GaussNoise", "prob": 0.3}, {"type": "Distortion", "prob": 0.5}, {"type": "LensDistortion", "prob": 0.3}, {"type": "Normalize", "mean": [123.675, 116.28, 103.53], "std": [58.395, 57.12, 57.375], "to_rgb": true}, {"type": "Pad", "size": [1024, 1024], "pad_val": 0, "seg_pad_val": 255}, {"type": "DefaultFormatBundle"}, {"type": "Collect", "keys": ["img", "gt_semantic_seg"]}], "cityscapes_train_pipeline": [{"type": "LoadImageFromFile"}, {"type": "LoadAnnotations"}, {"type": "Resize", "img_scale": [1920, 1080]}, {"type": "RandomCrop", "crop_size": [1024, 1024]}, {"type": "RandomFlip", "prob": 0.5}, {"type": "PhotoMetricDistortion"}, {"type": "Normalize", "mean": [123.675, 116.28, 103.53], "std": [58.395, 57.12, 57.375], "to_rgb": true}, {"type": "Pad", "size": [1024, 1024], "pad_val": 0, "seg_pad_val": 255}, {"type": "DefaultFormatBundle"}, {"type": "Collect", "keys": ["img", "gt_semantic_seg"]}], "test_pipeline": [{"type": "LoadImageFromFile"}, {"type": "MultiScaleFlipAug", "img_scale": [1920, 1080], "flip": false, "transforms": [{"type": "Resize", "keep_ratio": true}, {"type": "RandomFlip"}, {"type": "Normalize", "mean": [123.675, 116.28, 103.53], "std": [58.395, 57.12, 57.375], "to_rgb": true}, {"type": "ImageToTensor", "keys": ["img"]}, {"type": "Collect", "keys": ["img"]}]}], "data": {"samples_per_gpu": 2, "workers_per_gpu": 1, "train": {"type": "UDADataset", "source": {"type": "SourceDataset", "data_root": "data/samsung_total/", "img_dir": "images", "ann_dir": "labels", "pipeline": [{"type": "LoadImageFromFile"}, {"type": "LoadAnnotations"}, {"type": "Resize", "img_scale": [2048, 1024]}, {"type": "RandomCrop", "crop_size": [1024, 1024], "cat_max_ratio": 0.75}, {"type": "RandomFlip", "prob": 0.5}, {"type": "PhotoMetricDistortion"}, {"type": "GaussNoise", "prob": 0.3}, {"type": "Distortion", "prob": 0.5}, {"type": "LensDistortion", "prob": 0.3}, {"type": "Normalize", "mean": [123.675, 116.28, 103.53], "std": [58.395, 57.12, 57.375], "to_rgb": true}, {"type": "Pad", "size": [1024, 1024], "pad_val": 0, "seg_pad_val": 255}, {"type": "DefaultFormatBundle"}, {"type": "Collect", "keys": ["img", "gt_semantic_seg"]}]}, "target": {"type": "TargetDataset", "data_root": "data/samsung_target/", "img_dir": "images", "ann_dir": null, "pipeline": [{"type": "LoadImageFromFile"}, {"type": "LoadAnnotations"}, {"type": "Resize", "img_scale": [1920, 1080]}, {"type": "RandomCrop", "crop_size": [1024, 1024]}, {"type": "RandomFlip", "prob": 0.5}, {"type": "PhotoMetricDistortion"}, {"type": "Normalize", "mean": [123.675, 116.28, 103.53], "std": [58.395, 57.12, 57.375], "to_rgb": true}, {"type": "Pad", "size": [1024, 1024], "pad_val": 0, "seg_pad_val": 255}, {"type": "DefaultFormatBundle"}, {"type": "Collect", "keys": ["img", "gt_semantic_seg"]}], "crop_pseudo_margins": [30, 240, 30, 30]}, "rare_class_sampling": {"min_pixels": 3000, "class_temp": 0.01, "min_crop_ratio": 2.0}}, "val": {"type": "SourceDataset", "data_root": "data/samsung_valid/", "img_dir": "images", "ann_dir": "labels", "pipeline": [{"type": "LoadImageFromFile"}, {"type": "MultiScaleFlipAug", "img_scale": [1920, 1080], "flip": false, "transforms": [{"type": "Resize", "keep_ratio": true}, {"type": "RandomFlip"}, {"type": "Normalize", "mean": [123.675, 116.28, 103.53], "std": [58.395, 57.12, 57.375], "to_rgb": true}, {"type": "ImageToTensor", "keys": ["img"]}, {"type": "Collect", "keys": ["img"]}]}]}, "test": {"type": "TargetDataset", "data_root": "data/samsung_test/", "img_dir": "test_image", "ann_dir": null, "pipeline": [{"type": "LoadImageFromFile"}, {"type": "MultiScaleFlipAug", "img_scale": [1920, 1080], "flip": false, "transforms": [{"type": "Resize", "keep_ratio": true}, {"type": "RandomFlip"}, {"type": "Normalize", "mean": [123.675, 116.28, 103.53], "std": [58.395, 57.12, 57.375], "to_rgb": true}, {"type": "ImageToTensor", "keys": ["img"]}, {"type": "Collect", "keys": ["img"]}]}]}}, "uda": {"type": "DACS", "alpha": 0.99, "pseudo_threshold": 0.968, "pseudo_weight_ignore_top": 0, "pseudo_weight_ignore_bottom": 0, "imnet_feature_dist_lambda": 0, "imnet_feature_dist_classes": null, "imnet_feature_dist_scale_min_ratio": null, "mix": "class", "blur": true, "color_jitter_strength": 0.2, "color_jitter_probability": 0.2, "debug_img_interval": 1000, "print_grad_magnitude": false}, "use_ddp_wrapper": true, "optimizer": {"type": "AdamW", "lr": 6e-05, "betas": [0.9, 0.999], "weight_decay": 0.01, "paramwise_cfg": {"custom_keys": {"head": {"lr_mult": 10.0}, "pos_block": {"decay_mult": 0.0}, "norm": {"decay_mult": 0.0}}}}, "optimizer_config": null, "lr_config": {"policy": "poly", "warmup": "linear", "warmup_iters": 1500, "warmup_ratio": 1e-06, "power": 1.0, "min_lr": 0.0, "by_epoch": false}, "seed": 1, "n_gpus": 2, "gpu_model": "NVIDIA4090TI", "runner": {"type": "IterBasedRunner", "max_iters": 40000}, "checkpoint_config": {"by_epoch": false, "interval": 5000, "max_keep_ckpts": 1}, "evaluation": {"interval": 2000, "metric": "mIoU"}, "name": "230920_1710_aug2_samsung_newaug_441ad", "exp": "basic", "name_dataset": "samsungcityscapesHR_1024x1024", "name_architecture": "hrda1-512-0.1_daformer_sepaspp_sl_mitb5", "name_encoder": "mitb5", "name_decoder": "hrda1-512-0.1_daformer_sepaspp_sl", "name_uda": "dacs_a999_fdthings_rcs0.01-2.0_cpl2", "name_opt": "adamw_6e-05_pmTrue_poly10warm_1x2_40k", "work_dir": "work_dirs/local-basic/230920_1710_aug2_samsung_newaug_441ad", "git_rev": "f8aa28923b03afc3ec5686f4da176eea73083db8", "gpu_ids": [0]}